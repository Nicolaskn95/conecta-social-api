# Matriz de Risco — Conecta Social API

| Vulnerabilidade                                      | Tratamento | Ação                                                   | Responsável | Cód. | Descrição                                                                                                   | Impacto | Probabilidade | Nível de Risco |
|------------------------------------------------------|------------|--------------------------------------------------------|-------------|------|-------------------------------------------------------------------------------------------------------------|---------|---------------|----------------|
| Exposição de dados sensíveis em logs                 | Mitigado   | Sanitização de payloads e envio assíncrono para logger externo | TL          | R01  | Logs poderiam carregar senha/token; agora campos sensíveis são redigidos e envio não bloqueia a requisição  | 8       | 7             | 56 (Alto)      |
| Brute force de login / falta de rate limiting        | Em mitigação | Implementar rate limiting/MFA/lockout                 | TL          | R02  | Sem controle de tentativas ou MFA no endpoint de login                                                      | 6       | 5             | 30 (Médio)     |
| Falta de conversão implícita em DTOs numéricos       | Em mitigação | Habilitar `enableImplicitConversion` ou usar `@Type(() => Number)` | TL          | R03  | Campos numéricos via query/body podem falhar validação ou serem tratados como string                        | 3       | 3             | 9 (Baixo)      |
| Seeds/migrations bloqueando boot em produção         | Aceito     | Opcionalizar seed em prod ou rodar em pipeline         | PO          | R04  | EntryPoint roda migrate + seed a cada start; falha de DB impede inicialização                               | 8       | 3             | 24 (Médio)     |
| Exposição de dados de eventos públicos               | Em mitigação | Revisar resposta pública (endereço completo)           | TL          | R05  | Endpoints públicos retornam endereço completo de eventos                                                   | 6       | 3             | 18 (Médio)     |
| Sanitização/validação de URLs externas (Instagram)   | Mitigado   | Timeout, tratamento de ECONNREFUSED, validação via serviço externo com API key | TL | R07  | Dependência de microserviço externo; agora com timeout e API key                                            | 6       | 3             | 18 (Médio)     |
| Configuração de API key para microserviço Instagram  | Mitigado   | Header `x-api-key` validado e variável `INSTAGRAM_SERVICE_API_KEY` | TL | R08  | Requisições agora exigem chave; risco de acesso não autenticado mitigado                                    | 5       | 2             | 10 (Médio)     |
| Falta de normalização de e-mail no login             | Em mitigação | Normalizar e-mail antes de buscar usuário              | TL          | R09  | Login falha se e-mail vier com maiúsculas; impacto em UX/autenticação                                       | 2       | 3             | 6 (Baixo)      |
| Soft-delete sem política de retenção                 | Aceito     | Definir retenção ou purga periódica                    | PO          | R10  | Registros inativos permanecem no banco, podendo crescer indefinidamente                                     | 4       | 3             | 12 (Médio)     |

Legenda de tratamento: **Mitigado** = ação já aplicada; **Em mitigação** = ação planejada/pendente; **Aceito** = risco consciente. Responsável: TL = time líder técnico; PO = product owner.
